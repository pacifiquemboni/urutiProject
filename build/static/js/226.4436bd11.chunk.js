"use strict";(self.webpackChunkvuna_deile=self.webpackChunkvuna_deile||[]).push([[226],{7484:(e,n,a)=>{a.d(n,{A:()=>o,H:()=>i});var l=a(14710),s=a(76194),r=a(18062),t=a(91046);function i(e){let{children:n,className:a="",onClick:l}=e;return(0,t.jsx)("div",{className:`py-2 px-4 hover:bg-black hover:bg-opacity-5 ${a}`,onClick:l,children:n})}function o(e){let{children:n,positions:a,align:i,arrowColor:o,bordered:d,container:c,containerClassName:u,className:m=""}=e;const[v,h]=(0,l.useState)(!1);return(0,t.jsx)(r.Popover,{isOpen:v,positions:a||["left","right"],align:i||"center",padding:8,containerClassName:u,onClickOutside:e=>{e.target.closest(".ReactModalPortal")||h(!1)},content:e=>{let{position:a,childRect:l,popoverRect:s}=e;return(0,t.jsx)(r.ArrowContainer,{position:a,childRect:l,popoverRect:s,arrowColor:o||"#333",arrowSize:5,children:(0,t.jsx)("div",{className:`bg-slate-50 rounded-lg shadow-md !max-w-none min-w-44 overflow-auto ${d?"border border-solid border-blue-950 border-opacity-5":""} ${m}`,children:n})})},children:(0,t.jsx)("div",{onClick:()=>h(!v),className:"btn-container text-inherit",children:c||(0,t.jsx)(s.A,{size:"xsm3",className:"px-0 !border-transparent",outlined:!0,children:(0,t.jsx)("svg",{className:" min-w-[1.25rem] w-5 h-5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 4 15",children:(0,t.jsx)("path",{d:"M3.5 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 6.041a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 5.959a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"})})})})})}},78468:(e,n,a)=>{a.d(n,{A:()=>o});var l=a(39338),s=a(42215),r=a(47472),t=a(14710),i=a(91046);const o=function(e){var n,a,o,d;let{children:c,roles:u=[],permission:m,otherwise:v,fallback:h,...p}=e;const{good:x,bad:g}=(0,l.S)(u),{good:j,bad:f}=(0,l.S)(m?Array.isArray(m)?m:[m]:[""]),{user:b,status:y,allowedPermissions:w}=(0,s.G)((e=>e.user));return"pending"==y||"pending"==w.status?(0,i.jsx)(r.A,{}):(m?(null===w||void 0===w||null===(n=w.list)||void 0===n?void 0:n.some((e=>j.includes(e))))&&(null===w||void 0===w||null===(a=w.list)||void 0===a||!a.some((e=>f.includes(e)))):0===u.length||g.length&&!g.includes(null===b||void 0===b||null===(o=b.role)||void 0===o?void 0:o.toLowerCase())||x.length&&(null===x||void 0===x?void 0:x.includes(null===b||void 0===b||null===(d=b.role)||void 0===d?void 0:d.toLowerCase())))?(0,i.jsx)(t.Fragment,{...p,children:c}):v||(h?(0,i.jsx)(t.Fragment,{...p,children:h}):(0,i.jsx)(t.Fragment,{...p}))}},98401:(e,n,a)=>{a.d(n,{A:()=>r});new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),new Intl.NumberFormat(void 0,{style:"currency",currency:"Rwf",minimumFractionDigits:2}),new Intl.NumberFormat(void 0,{style:"currency",currency:"TSH",minimumFractionDigits:2});var l=a(14710),s=a(91046);function r(e){let{amount:n=0,currency:a="Tsh",currencySize:r}=e;const t=(0,l.useMemo)((()=>function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return new Intl.NumberFormat(void 0,{style:"currency",currency:e,...n})}catch(a){return console.warn(a),new Intl.NumberFormat(void 0,{style:"currency",currency:"Rwf"})}}(a).formatToParts(n)),[n,a]);return t.map(((e,n)=>(0,s.jsx)("span",{className:0==n?r||"text-xs":"",children:e.value},n)))}},74184:(e,n,a)=>{a.d(n,{A:()=>d});var l=a(14710),s=a(87718),r=a(91046);const t=(0,l.forwardRef)(((e,n)=>{let{filterFn:a,...t}=e;const i=(0,l.useCallback)((e=>new Promise((n=>n(null===a||void 0===a?void 0:a(e))))),[a]),o=(0,l.useRef)(n);return(0,r.jsx)(s.A,{ref:o,cacheOptions:!0,defaultOptions:!0,loadOptions:i,...t})}));var i=a(68852);const o=async e=>{try{var n,a,l;const s=await i.pY.get(`/v1/category?search=${e}`,{params:{pageSize:8,pageNumber:1}});return null===(n=[{id:null,name:"Select Radio"},...(null===s||void 0===s||null===(l=s.data)||void 0===l?void 0:l.list)||[]])||void 0===n||null===(a=n.map)||void 0===a?void 0:a.call(n,(e=>({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.name})))}catch(s){return[]}};function d(e){let{radioId:n,setRadioId:a,className:l=""}=e;return(0,r.jsxs)("label",{htmlFor:"radioId",className:`sm:col-span-2 ${l}`,onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("span",{className:"text-neutral-700 mb-2 inline-block",children:"Select Radio"}),(0,r.jsx)(t,{id:"radioId",name:"radioId",className:"bg-neutral-200",styles:{control:e=>({...e,border:"none",boxShadow:"none",background:"transparent",borderRadius:".2rem"}),valueContainer:e=>({...e,paddingInline:"1rem"})},filterFn:o,onChange:e=>a(null===e||void 0===e?void 0:e.value),defaultInputValue:n||""})]})}},16330:(e,n,a)=>{a.d(n,{A:()=>i,w:()=>o});var l=a(62979),s=a.n(l),r=a(76194),t=a(91046);function i(e){let{children:n,isOpen:a,onRequestClose:l,className:r,size:i}=e;return(0,t.jsx)(s(),{isOpen:a,onRequestClose:l,className:`${i?`size_${i}`:""} ${r||""}`,children:n})}function o(e){let{onClose:n,title:a}=e;return(0,t.jsxs)("div",{className:"flex justify-between mb-4",children:["string"==typeof a?(0,t.jsx)("h3",{children:a}):a,(0,t.jsx)(r.A,{className:"!text-black !bg-transparent !p-0",size:"xsm2",onClick:()=>n(),children:"X"})]})}s().setAppElement("#modals")},73887:(e,n,a)=>{a.d(n,{Py:()=>r,V6:()=>t,ZI:()=>s});var l=a(72063);const s=new Date,r=new Date("2024-02-05");async function t(e){const n=new FormData;n.append("file",e),n.append("upload_preset","m0gzvc3m");const a=await l.A.post("https://api.cloudinary.com/v1_1/dibojibkz/image/upload",n);return null===a||void 0===a?void 0:a.data}},64226:(e,n,a)=>{a.r(n),a.d(n,{default:()=>D});var l=a(98401),s=a(99679),r=a(10674),t=a(42215),i=a(4449),o=a.n(i),d=a(14710),c=a(74184),u=a(73887),m=a(76194),v=a(94055),h=a(95834),p=a(28932),x=a(18345),g=a(86298),j=a(91046);function f(e){let{onFilter:n}=e;const[a,l]=(0,d.useState)(null),{user:s}=(0,t.G)((e=>e.user)),[r,i]=(0,d.useState)([{startDate:u.Py,endDate:u.ZI,key:"selection"}]),f=(0,d.useCallback)((async(e,l)=>{let{setSubmitting:s}=l;null===n||void 0===n||n({...e,radioId:a}),s(!1)}),[n,a]);return(0,j.jsx)(x.l1,{initialValues:{from:o()(u.Py).format("YYYY-MM-DD"),to:o()(u.ZI).format("YYYY-MM-DD"),submit:null},onSubmit:f,children:e=>{var n,t;let{values:d,resetForm:x,isSubmitting:f,handleSubmit:b,handleChange:y,setValues:w}=e;return(0,j.jsxs)("form",{className:"grid gap-3",onSubmit:b,children:[(0,j.jsxs)("div",{className:"hidden",children:[(0,j.jsx)(v.pd,{name:"from",type:"date",value:null===d||void 0===d?void 0:d.from,onChange:y}),(0,j.jsx)(v.pd,{name:"to",type:"date",value:null===d||void 0===d?void 0:d.to,onChange:y})]}),(0,j.jsx)(p.A,{mouseEnterDelay:.5,mouseLeaveDelay:.5,content:(0,j.jsx)(g.Ur,{onChange:e=>{let{selection:n}=e;i([n]),w((e=>({...e,from:o()(n.startDate).format("YYYY-MM-DD"),to:o()(n.endDate).format("YYYY-MM-DD")})))},moveRangeOnFirstSelection:!1,months:1,ranges:r,direction:"horizontal",preventSnapRefocus:!0,calendarFocus:"backwards",rangeColors:["var(--primary-color)"],maxDate:u.ZI,minDate:u.Py}),children:(0,j.jsxs)("div",{className:"cursor-pointer",children:[(0,j.jsx)("p",{className:"mb-1 text-grey",children:"Select Date Range"}),(0,j.jsxs)("span",{className:"flex gap-2 items-center [&>*]:p-1 [&>*]:px-3 [&>*]:bg-light-grey [&>*]:bg-opacity-30 [&>*]:rounded-md",children:[(0,j.jsx)("span",{children:o()(r[0].startDate).format("LL")}),"-",(0,j.jsx)("span",{children:o()(r[0].endDate).format("LL")})]})]})}),1!=(null===s||void 0===s||null===(n=s.attributes)||void 0===n||null===(t=n.radioId)||void 0===t?void 0:t.length)&&(0,j.jsx)(c.A,{radioId:a,setRadioId:l,className:"!col-span-1"}),(0,j.jsxs)("div",{className:"flex justify-end pt-2 gap-2",children:[(0,j.jsx)(m.A,{onClick:()=>x(),outlined:!0,disabled:f,size:"xsm",className:"!rounded-full",children:"Reset"}),(0,j.jsx)(m.A,{type:"submit",disabled:f,size:"xsm",className:"!rounded-full",icon:f&&(0,j.jsx)(h.A,{size:16}),children:"Filter"})]})]})}})}var b=a(78673),y=a(7484),w=a(78468),C=a(22867),k=a(11108),N=a(16330),A=a(34049);function R(e){let{data:n}=e;return(0,j.jsx)(w.A,{permission:["register_won_token"],children:(0,j.jsxs)(y.A,{children:[(0,j.jsx)(w.A,{permission:["register_won_token"],children:(0,j.jsx)(I,{data:null===n||void 0===n?void 0:n.original})}),(0,j.jsx)(w.A,{permission:["reject_temp_winner"],children:(0,j.jsx)(S,{data:null===n||void 0===n?void 0:n.original})})]})})}function I(e){let{data:n}=e;const[a,l]=(0,d.useState)(!1),[s,r]=(0,d.useState)(!1),i=(0,t.j)(),o=(0,d.useCallback)((async()=>{r(!0);const e=A.oR.loading("confirming winner...");try{await i((0,b.PO)(null===n||void 0===n?void 0:n.tokenId)).unwrap(),A.oR.update(e,{render:"Winner confirmed successfully!",type:"success",isLoading:!1,autoClose:5e3})}catch(a){A.oR.update(e,{render:"Error in confirming winner.",type:"error",isLoading:!1,autoClose:5e3})}r(!1)}),[null===n||void 0===n?void 0:n.tokenId,i]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"px-4 py-2 hover:bg-black hover:bg-opacity-5 flex items-center",onClick:()=>l(!0),children:[(0,j.jsx)(C.A,{className:"w-4"}),(0,j.jsx)("span",{className:"pl-3",children:"Confirm Winner"})]}),(0,j.jsxs)(N.A,{size:"sm",isOpen:a,onRequestClose:()=>l(!1),children:[(0,j.jsx)(N.w,{title:"Confirm Winner",onClose:()=>l(!1)}),(0,j.jsxs)("p",{className:"max-w-[40ch]",children:["Are you sure you want to Confirm token ",(0,j.jsx)("br",{}),(0,j.jsx)("b",{children:null===n||void 0===n?void 0:n.tokenId})," as a winner?"]}),(0,j.jsx)("div",{className:"flex mt-4",children:(0,j.jsxs)("div",{className:"flex-1 flex justify-end gap-2",children:[(0,j.jsx)(m.A,{size:"xsm",className:"!rounded-full",onClick:()=>l(!1),disabled:s,outlined:!0,children:"No thanks"}),(0,j.jsx)(m.A,{size:"xsm",className:"!rounded-full",onClick:o,disabled:s,children:"Confirm"})]})})]})]})}function S(e){let{data:n}=e;const[a,l]=(0,d.useState)(!1),[s,r]=(0,d.useState)(!1),i=(0,t.j)(),o=(0,d.useCallback)((async()=>{r(!0);const e=A.oR.loading("Rejecting winner...");try{await i((0,b.Xp)(null===n||void 0===n?void 0:n.tokenId)).unwrap(),A.oR.update(e,{render:"Winner Rejected successfully!",type:"success",isLoading:!1,autoClose:5e3})}catch(a){A.oR.update(e,{render:"Error in Rejectinng winner.",type:"error",isLoading:!1,autoClose:5e3})}r(!1)}),[null===n||void 0===n?void 0:n.tokenId,i]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"px-4 py-2 text-red-500 hover:bg-black hover:bg-opacity-5 flex items-center",onClick:()=>l(!0),children:[(0,j.jsx)(k.A,{className:"w-4"}),(0,j.jsx)("span",{className:"pl-3",children:"Reject Winner"})]}),(0,j.jsxs)(N.A,{size:"sm",isOpen:a,onRequestClose:()=>l(!1),children:[(0,j.jsx)(N.w,{title:"Confirm Winner",onClose:()=>l(!1)}),(0,j.jsxs)("p",{className:"max-w-[40ch]",children:["Are you sure you want to Reject token ",(0,j.jsx)("br",{}),(0,j.jsx)("b",{children:null===n||void 0===n?void 0:n.tokenId}),"?"]}),(0,j.jsx)("div",{className:"flex mt-4",children:(0,j.jsxs)("div",{className:"flex-1 flex justify-end gap-2",children:[(0,j.jsx)(m.A,{size:"xsm",className:"!rounded-full",onClick:()=>l(!1),disabled:s,outlined:!0,children:"No thanks"}),(0,j.jsx)(m.A,{size:"xsm",className:"!rounded-full",onClick:o,disabled:s,children:"Reject"})]})})]})]})}function D(){var e;const n=(0,t.j)(),{list:a,status:i,fetchTimes:c,info:u,filters:m}=(0,t.G)((e=>e.draw.tempWon)),{user:v}=(0,t.G)((e=>e.user)),h=(0,d.useMemo)((()=>[{accessor:"tokenId",Header:"token",Filter:()=>(0,j.jsx)(j.Fragment,{})},{accessor:"phoneNumber",Header:"Phone"},{accessor:"created_at",Header:"created date",Cell:e=>{let{value:n}=e;return o()(n).format("llll")}},{accessor:"draw[startDate]",Header:"draw",Cell:e=>{var n;let{value:a,row:{original:l}}=e;return(0,j.jsxs)(j.Fragment,{children:[o()(a).format("ll")," - ",o()(null===l||void 0===l||null===(n=l.draw)||void 0===n?void 0:n.endDate).format("ll")]})}},{accessor:"draw[product[productName]]",Header:"Prize"},{accessor:"product[playAmount]",Header:"Pray Amount",Cell:e=>{let{value:n}=e;return(0,j.jsx)(l.A,{amount:Number(n)})}},{id:"actions",Cell:e=>{let{row:n}=e;return(0,j.jsx)(R,{data:n})}}]),[]),p=(0,d.useCallback)((async e=>{try{var a,l,s,r;1==(null===v||void 0===v||null===(a=v.attributes)||void 0===a||null===(l=a.radioId)||void 0===l?void 0:l.length)&&(e.radioId=(null===v||void 0===v||null===(s=v.attributes)||void 0===s||null===(r=s.radioId)||void 0===r?void 0:r[0])||(null===e||void 0===e?void 0:e.radioId)),await n((0,b.nX)(e)).unwrap()}catch(t){}}),[n,null===v||void 0===v||null===(e=v.attributes)||void 0===e?void 0:e.radioId]);(0,d.useLayoutEffect)((()=>{0==c&&p()}),[c,p,a.length]);const x=(0,d.useCallback)((e=>{n((0,r.Uk)(e)),p(e)}),[n,p]),g=(0,d.useCallback)((e=>{p({...m,pageNumber:((null===u||void 0===u?void 0:u.currentPage)||0)+(e||1)})}),[m,p,null===u||void 0===u?void 0:u.currentPage]);return(0,j.jsx)(j.Fragment,{children:(0,j.jsx)("div",{className:"p-4",children:(0,j.jsx)(s.A,{title:"Temporaly Winners",columns:h,data:a,loading:"pending"==i,refresh:()=>p(),totalResults:null===u||void 0===u?void 0:u.total,allowExport:!0,AsideNode:f,minimizeFilter:!0,hidePageSizeSelector:!0,hideSearch:!0,onFilter:x,customPaginationActions:!0,currentPage:null===u||void 0===u?void 0:u.currentPage,defaultPageSize:m.pageSize||10,getMore:g})})})}},22867:(e,n,a)=>{a.d(n,{A:()=>l});var l=(0,a(79).A)("checks","IconChecks",[["path",{d:"M7 12l5 5l10 -10",key:"svg-0"}],["path",{d:"M2 12l5 5m5 -5l5 -5",key:"svg-1"}]])},11108:(e,n,a)=>{a.d(n,{A:()=>l});var l=(0,a(79).A)("trash-x","IconTrashX",[["path",{d:"M4 7h16",key:"svg-0"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-1"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-2"}],["path",{d:"M10 12l4 4m0 -4l-4 4",key:"svg-3"}]])}}]);
//# sourceMappingURL=226.4436bd11.chunk.js.map