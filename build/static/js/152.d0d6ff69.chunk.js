"use strict";(self.webpackChunkvuna_deile=self.webpackChunkvuna_deile||[]).push([[152],{98401:(e,l,n)=>{n.d(l,{A:()=>o});new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),new Intl.NumberFormat(void 0,{style:"currency",currency:"Rwf",minimumFractionDigits:2}),new Intl.NumberFormat(void 0,{style:"currency",currency:"TSH",minimumFractionDigits:2});var t=n(14710),a=n(91046);function o(e){let{amount:l=0,currency:n="Tsh",currencySize:o}=e;const i=(0,t.useMemo)((()=>function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return new Intl.NumberFormat(void 0,{style:"currency",currency:e,...l})}catch(n){return console.warn(n),new Intl.NumberFormat(void 0,{style:"currency",currency:"Rwf"})}}(n).formatToParts(l)),[l,n]);return i.map(((e,l)=>(0,a.jsx)("span",{className:0==l?o||"text-xs":"",children:e.value},l)))}},74184:(e,l,n)=>{n.d(l,{A:()=>d});var t=n(14710),a=n(87718),o=n(91046);const i=(0,t.forwardRef)(((e,l)=>{let{filterFn:n,...i}=e;const s=(0,t.useCallback)((e=>new Promise((l=>l(null===n||void 0===n?void 0:n(e))))),[n]),r=(0,t.useRef)(l);return(0,o.jsx)(a.A,{ref:r,cacheOptions:!0,defaultOptions:!0,loadOptions:s,...i})}));var s=n(68852);const r=async e=>{try{var l,n,t;const a=await s.pY.get(`/v1/category?search=${e}`,{params:{pageSize:8,pageNumber:1}});return null===(l=[{id:null,name:"Select Radio"},...(null===a||void 0===a||null===(t=a.data)||void 0===t?void 0:t.list)||[]])||void 0===l||null===(n=l.map)||void 0===n?void 0:n.call(l,(e=>({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.name})))}catch(a){return[]}};function d(e){let{radioId:l,setRadioId:n,className:t=""}=e;return(0,o.jsxs)("label",{htmlFor:"radioId",className:`sm:col-span-2 ${t}`,onClick:e=>e.stopPropagation(),children:[(0,o.jsx)("span",{className:"text-neutral-700 mb-2 inline-block",children:"Select Radio"}),(0,o.jsx)(i,{id:"radioId",name:"radioId",className:"bg-neutral-200",styles:{control:e=>({...e,border:"none",boxShadow:"none",background:"transparent",borderRadius:".2rem"}),valueContainer:e=>({...e,paddingInline:"1rem"})},filterFn:r,onChange:e=>n(null===e||void 0===e?void 0:e.value),defaultInputValue:l||""})]})}},52582:(e,l,n)=>{n.d(l,{A:()=>a});var t=n(91046);function a(e){let{className:l=""}=e;return(0,t.jsx)("div",{className:`h-[1.5px] bg-light-grey my-3 mt-6 ${l}`,style:{boxShadow:"-10rem 0 0 var(--light-grey-color), 10rem 0 0 var(--light-grey-color)"}})}},26498:(e,l,n)=>{n.r(l),n.d(l,{default:()=>A});var t=n(14244),a=n(42215),o=n(14710),i=n(52582),s=n(91046);function r(e){let{title:l,children:n,className:t=""}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:`flex flex-col gap-4 px-4 py-6 rounded-lg bg-light-grey bg-opacity-40 ${t}`,children:[(0,s.jsx)("div",{className:"flex gap-2 justify-between",children:(0,s.jsx)("h3",{children:l})}),(0,s.jsx)("div",{children:n})]})})}var d=n(98401),c=n(78468),u=n(14206),v=n(4449),m=n.n(v),p=n(76194),g=n(74184),h=n(94055),x=n(73887),f=n(94569),j=n(95834),b=n(28932),y=n(18345),N=n(86298);function S(e){let{onFilter:l}=e;const{user:n}=(0,a.G)((e=>e.user)),[t,i]=(0,o.useState)(null),{list:r,fetchTimes:d}=(0,a.G)((e=>e.products)),c=(0,a.j)();(0,o.useEffect)((()=>{d<1&&c((0,f.bn)({pageSize:1e3}))}),[c,d]);const[u,v]=(0,o.useState)([{startDate:new Date,endDate:new Date((new Date).getDate()+7),key:"selection"}]),S=(0,o.useCallback)((async(e,n)=>{let{setSubmitting:a}=n;null!==e&&void 0!==e&&e.to&&(e.to=m()(e.to).add("23"==m()(e.to).format("HH")?0:86369,"seconds").format("YYYY-MM-DD HH:mm")),null===l||void 0===l||l({...e,radioId:t}),a(!1)}),[l,t]);return(0,s.jsx)(y.l1,{initialValues:{search:"",from:"",to:"",telecom:"",productId:"",submit:null},onSubmit:S,children:e=>{var l,a,o;let{values:d,isSubmitting:c,handleSubmit:f,handleChange:y,setValues:S}=e;return(0,s.jsxs)("form",{className:"grid gap-3",onSubmit:f,children:[(0,s.jsx)(h.pd,{name:"search",label:"Search",onChange:y,value:null===d||void 0===d?void 0:d.search,placeholder:"search"}),(0,s.jsxs)("div",{className:"hidden",children:[(0,s.jsx)(h.pd,{name:"from",type:"date",value:null===d||void 0===d?void 0:d.from,onChange:y}),(0,s.jsx)(h.pd,{name:"to",type:"date",value:null===d||void 0===d?void 0:d.to,onChange:y})]}),(0,s.jsx)(b.A,{mouseEnterDelay:.5,mouseLeaveDelay:.5,content:(0,s.jsx)(N.Ur,{onChange:e=>{let{selection:l}=e;v([l]),S((e=>({...e,from:m()(l.startDate).format("YYYY-MM-DD"),to:m()(l.endDate).format("YYYY-MM-DD")})))},moveRangeOnFirstSelection:!1,months:1,ranges:u,direction:"horizontal",preventSnapRefocus:!0,calendarFocus:"backwards",rangeColors:["var(--primary-color)"],maxDate:x.ZI,minDate:x.Py}),children:(0,s.jsxs)("div",{className:"cursor-pointer",children:[(0,s.jsx)("p",{className:"mb-1 text-grey",children:"Select Date Range"}),(0,s.jsxs)("span",{className:"flex gap-2 items-center [&>*]:text-center [&>*]:flex-grow [&>*]:p-1 [&>*]:px-3 [&>*]:bg-light-grey [&>*]:bg-opacity-30 [&>*]:rounded-md",children:[(0,s.jsx)("span",{children:null!==d&&void 0!==d&&d.from?m()(null===d||void 0===d?void 0:d.from).format("LL"):"Not Selected"}),"-",(0,s.jsx)("span",{children:null!==d&&void 0!==d&&d.to?m()(null===d||void 0===d?void 0:d.to).format("LL"):"Not Selected"})]})]})}),1!=(null===n||void 0===n||null===(l=n.attributes)||void 0===l||null===(a=l.radioId)||void 0===a?void 0:a.length)&&(0,s.jsx)(g.A,{radioId:t,setRadioId:i,className:"!col-span-1"}),(0,s.jsx)(h.l6,{name:"telecom",label:"select Telecom",value:null===d||void 0===d?void 0:d.telecom,onChange:y,placeholder:"All Telecom",options:["telco","Halopesa","AirtelMoneyTz","TigoPesaTz","Vodacom Tz MPESA"]}),(0,s.jsx)(h.l6,{name:"productId",label:"select Product",value:null===d||void 0===d?void 0:d.productId,onChange:y,placeholder:"All Products",options:null===r||void 0===r||null===(o=r.map)||void 0===o?void 0:o.call(r,(e=>({value:null===e||void 0===e?void 0:e.productId,text:null===e||void 0===e?void 0:e.productName})))}),(0,s.jsxs)("div",{className:"flex justify-end pt-2 gap-2",children:[(0,s.jsx)(p.A,{type:"reset",outlined:!0,disabled:c,size:"xsm",className:"!rounded-full",children:"Reset"}),(0,s.jsx)(p.A,{type:"submit",disabled:c,size:"xsm",className:"!rounded-full",icon:c&&(0,s.jsx)(j.A,{size:16}),children:"Filter"})]})]})}})}var w=n(12034),F=n(59282);var D=n(16330);function C(){const e=(0,a.j)(),l=(0,o.useMemo)((()=>[{accessorFn:e=>e.phone_number,header:"Phone Number"},{accessorFn:e=>null===e||void 0===e?void 0:e.totalHits,header:"Total Hits",cell:e=>{let{getValue:l}=e;return(0,s.jsx)(w.A,{value:Number(l()),clickToggle:!0})}},{accessorFn:e=>e.totalSuccess,header:"Success Hits",cell:e=>{let{getValue:l}=e;return(0,s.jsx)(w.A,{value:Number(l()),clickToggle:!0})}},{accessorFn:e=>e.totalFailed,header:"Failed Hits",cell:e=>{let{getValue:l}=e;return(0,s.jsx)(w.A,{value:Number(l()),clickToggle:!0})}}]),[]),[n,i]=(0,o.useState)([]),[r,d]=(0,o.useState)({}),[c,v]=(0,o.useState)(!1),m=function(e){const[l,n]=(0,F.ok)();return{isOpen:(0,o.useMemo)((()=>(null===l||void 0===l?void 0:l.get("m"))==e),[l,e]),open:(0,o.useCallback)((()=>{n((l=>(l.delete("m"),l.append("m",e),l)),{replace:!0})}),[e,n]),close:(0,o.useCallback)((()=>{n((e=>(e.delete("m"),e)),{replace:!0})}),[n])}}("hits"),g=(0,o.useCallback)((async l=>{let{type:n,options:a}=l;try{var o,s,r;"export"!=n&&v(!0);const l={pageSize:(null===a||void 0===a?void 0:a.pagination)&&(null===a||void 0===a||null===(o=a.pagination)||void 0===o?void 0:o.pageSize)||10,pageNumber:(null===a||void 0===a?void 0:a.pagination)&&(null!==(s=null===a||void 0===a||null===(r=a.pagination)||void 0===r?void 0:r.pageNumber)&&void 0!==s?s:1)+1};if("export"==n){const n=await e((0,t.gN)(l)).unwrap();return null===n||void 0===n?void 0:n.list}{const n=await e((0,t.gN)(l)).unwrap(),{list:a,...o}=n;return i(a),d(o),null===n||void 0===n?void 0:n.list}}catch(c){}finally{v(!1)}}),[e]);return(0,o.useLayoutEffect)((()=>{g({})}),[g]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.A,{size:"xsm",onClick:()=>null===m||void 0===m?void 0:m.open(),children:"Get Hits"}),(0,s.jsx)(D.A,{isOpen:null===m||void 0===m?void 0:m.isOpen,size:"sm",onRequestClose:()=>null===m||void 0===m?void 0:m.close(),children:(0,s.jsx)(u.A,{title:"Hits",columns:l,data:n,loading:c,getData:g,customPagination:!0,allowExport:!0,pagination:{totalPages:Math.ceil((null===r||void 0===r?void 0:r.total)/((null===n||void 0===n?void 0:n.length)<10?10:null===n||void 0===n?void 0:n.length)),pageNumber:((null===r||void 0===r?void 0:r.currentPage)||1)-1,pageSize:(null===n||void 0===n?void 0:n.length)<10?10:null===n||void 0===n?void 0:n.length,total:null===r||void 0===r?void 0:r.total}})})]})}function A(){var e,l,n,v,p,g,h,x,f,j,b,y;const N=(0,a.j)(),{list:w,status:F,info:D,reports:{data:A}}=(0,a.G)((e=>e.transactions)),[I,Y]=(0,o.useState)(!1),k=(0,o.useMemo)((()=>[{accessorFn:e=>null===e||void 0===e?void 0:e.transactionId,header:"transaction Id"},{accessorFn:e=>e.phone_number,header:"Phone Number"},{accessorFn:e=>e.product.productName,header:"prize"},{accessorFn:e=>e.amount,header:"Amount",filterFn:"inNumberRange"},{accessorFn:e=>e.telco,header:"Telco"},{accessorFn:e=>e.status,header:"Status",cell:e=>{let{getValue:l}=e;const n=l();return(0,s.jsx)("span",{className:""+("successful"==(null===n||void 0===n?void 0:n.toLowerCase())?"text-green-600":"pending"==(null===n||void 0===n?void 0:n.toLowerCase())?"text-orange-500":"text-red-600"),children:null===n||void 0===n?void 0:n.toLowerCase()})}},{accessorFn:e=>e.created_at,header:"Transaction Date",cell:e=>{let{getValue:l}=e;return m()(`${l()}`).format("LLL")}},{accessorFn:e=>e.expired,header:"expired",cell:e=>{let{getValue:l}=e;return(0,s.jsx)("span",{className:""+(l()?"text-green-600":"text-red-600"),children:l()?"true":"false"})}}]),[]),T=(0,o.useCallback)((async e=>{try{await N((0,t.mc)(e))}catch(l){}}),[N]),z=(0,o.useCallback)((async e=>{let{type:l,options:n}=e;try{var a,o,i;const e={...null===n||void 0===n?void 0:n.filters,pageSize:(null===n||void 0===n?void 0:n.pagination)&&(null===n||void 0===n||null===(a=n.pagination)||void 0===a?void 0:a.pageSize)||10,pageNumber:(null===n||void 0===n?void 0:n.pagination)&&(null!==(o=null===n||void 0===n||null===(i=n.pagination)||void 0===i?void 0:i.pageNumber)&&void 0!==o?o:1)+1};if(["filter","refresh"].includes(`${l}`)&&T(null===n||void 0===n?void 0:n.filters),"export"==l){const l=await N((0,t.Yf)(e)).unwrap();return null===l||void 0===l?void 0:l.list}{const l=await N((0,t.Kb)(e)).unwrap();return null===l||void 0===l?void 0:l.list}}catch(s){}}),[N,T]);return(0,o.useLayoutEffect)((()=>{I||(z({}),T({from:m()().format("LLLL"),to:m()(m()().format("YYYY-MM-DD")).add(86369,"seconds").format("YYYY-MM-DD HH:mm")}),Y(!0))}),[I,z,T]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"p-4",children:(0,s.jsx)(u.A,{title:"Transactions",columns:k,data:w,getData:z,customPagination:!0,pagination:{totalPages:null===D||void 0===D?void 0:D.lastPage,pageNumber:((null===D||void 0===D?void 0:D.currentPage)||1)-1,pageSize:(null===w||void 0===w?void 0:w.length)<10?10:null===w||void 0===w?void 0:w.length,total:null===D||void 0===D?void 0:D.total},loading:"pending"==F,allowExport:!0,AsideNode:S,RightNode:()=>(0,s.jsx)(C,{})})}),(0,s.jsxs)(c.A,{permission:["view_reports"],children:[(0,s.jsx)(i.A,{className:"!my-0 h-[0.8px]"}),(0,s.jsxs)("section",{className:"grid grid-cols-1 gap-2 md:grid-cols-3 p-2",children:[(0,s.jsxs)(r,{title:"Transactions",children:[(0,s.jsx)("strong",{className:"text-2xl",children:(null===A||void 0===A||null===(e=A.total_transaction)||void 0===e||null===(l=e.cumulative)||void 0===l?void 0:l.transaction)||0}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-grey",children:"Current Tx"})," ",(0,s.jsx)("b",{children:(null===A||void 0===A||null===(n=A.total_transaction)||void 0===n||null===(v=n.current)||void 0===v?void 0:v.transaction)||0})]})]}),(0,s.jsxs)(r,{title:"Unique Transactions",children:[(0,s.jsx)("strong",{className:"text-2xl",children:(null===A||void 0===A||null===(p=A.unique)||void 0===p||null===(g=p.cumulative)||void 0===g?void 0:g.uniqueHits)||0}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-grey",children:"Current Unique Tx"})," ",(0,s.jsx)("b",{children:(null===A||void 0===A||null===(h=A.unique)||void 0===h||null===(x=h.current)||void 0===x?void 0:x.uniqueHits)||0})]})]}),(0,s.jsxs)(r,{title:"Revenue",children:[(0,s.jsx)("strong",{className:"text-2xl",children:(0,s.jsx)(d.A,{amount:null===A||void 0===A||null===(f=A.total_transaction)||void 0===f||null===(j=f.cumulative)||void 0===j?void 0:j.revenue})}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-grey",children:"Current Revenue"})," ",(0,s.jsx)("b",{children:(0,s.jsx)(d.A,{amount:null===A||void 0===A||null===(b=A.total_transaction)||void 0===b||null===(y=b.current)||void 0===y?void 0:y.revenue})})]})]})]})]})]})}}}]);
//# sourceMappingURL=152.d0d6ff69.chunk.js.map