"use strict";(self.webpackChunkvuna_deile=self.webpackChunkvuna_deile||[]).push([[416],{7484:(e,a,n)=>{n.d(a,{A:()=>d,H:()=>i});var l=n(14710),r=n(76194),t=n(18062),o=n(91046);function i(e){let{children:a,className:n="",onClick:l}=e;return(0,o.jsx)("div",{className:`py-2 px-4 hover:bg-black hover:bg-opacity-5 ${n}`,onClick:l,children:a})}function d(e){let{children:a,positions:n,align:i,arrowColor:d,bordered:s,container:c,containerClassName:u,className:m=""}=e;const[v,h]=(0,l.useState)(!1);return(0,o.jsx)(t.Popover,{isOpen:v,positions:n||["left","right"],align:i||"center",padding:8,containerClassName:u,onClickOutside:e=>{e.target.closest(".ReactModalPortal")||h(!1)},content:e=>{let{position:n,childRect:l,popoverRect:r}=e;return(0,o.jsx)(t.ArrowContainer,{position:n,childRect:l,popoverRect:r,arrowColor:d||"#333",arrowSize:5,children:(0,o.jsx)("div",{className:`bg-slate-50 rounded-lg shadow-md !max-w-none min-w-44 overflow-auto ${s?"border border-solid border-blue-950 border-opacity-5":""} ${m}`,children:a})})},children:(0,o.jsx)("div",{onClick:()=>h(!v),className:"btn-container text-inherit",children:c||(0,o.jsx)(r.A,{size:"xsm3",className:"px-0 !border-transparent",outlined:!0,children:(0,o.jsx)("svg",{className:" min-w-[1.25rem] w-5 h-5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 4 15",children:(0,o.jsx)("path",{d:"M3.5 1.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 6.041a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm0 5.959a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"})})})})})}},98401:(e,a,n)=>{n.d(a,{A:()=>t});new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),new Intl.NumberFormat(void 0,{style:"currency",currency:"Rwf",minimumFractionDigits:2}),new Intl.NumberFormat(void 0,{style:"currency",currency:"TSH",minimumFractionDigits:2});var l=n(14710),r=n(91046);function t(e){let{amount:a=0,currency:n="Tsh",currencySize:t}=e;const o=(0,l.useMemo)((()=>function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return new Intl.NumberFormat(void 0,{style:"currency",currency:e,...a})}catch(n){return console.warn(n),new Intl.NumberFormat(void 0,{style:"currency",currency:"Rwf"})}}(n).formatToParts(a)),[a,n]);return o.map(((e,a)=>(0,r.jsx)("span",{className:0==a?t||"text-xs":"",children:e.value},a)))}},74184:(e,a,n)=>{n.d(a,{A:()=>s});var l=n(14710),r=n(87718),t=n(91046);const o=(0,l.forwardRef)(((e,a)=>{let{filterFn:n,...o}=e;const i=(0,l.useCallback)((e=>new Promise((a=>a(null===n||void 0===n?void 0:n(e))))),[n]),d=(0,l.useRef)(a);return(0,t.jsx)(r.A,{ref:d,cacheOptions:!0,defaultOptions:!0,loadOptions:i,...o})}));var i=n(68852);const d=async e=>{try{var a,n,l;const r=await i.pY.get(`/v1/category?search=${e}`,{params:{pageSize:8,pageNumber:1}});return null===(a=[{id:null,name:"Select Radio"},...(null===r||void 0===r||null===(l=r.data)||void 0===l?void 0:l.list)||[]])||void 0===a||null===(n=a.map)||void 0===n?void 0:n.call(a,(e=>({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.name})))}catch(r){return[]}};function s(e){let{radioId:a,setRadioId:n,className:l=""}=e;return(0,t.jsxs)("label",{htmlFor:"radioId",className:`sm:col-span-2 ${l}`,onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("span",{className:"text-neutral-700 mb-2 inline-block",children:"Select Radio"}),(0,t.jsx)(o,{id:"radioId",name:"radioId",className:"bg-neutral-200",styles:{control:e=>({...e,border:"none",boxShadow:"none",background:"transparent",borderRadius:".2rem"}),valueContainer:e=>({...e,paddingInline:"1rem"})},filterFn:d,onChange:e=>n(null===e||void 0===e?void 0:e.value),defaultInputValue:a||""})]})}},44066:(e,a,n)=>{n.r(a),n.d(a,{default:()=>A});var l=n(98401),r=n(14219),t=n(42215),o=n(4449),i=n.n(o),d=n(14710),s=n(74184),c=n(73887),u=n(76194),m=n(94055),v=n(95834),h=n(28932),p=n(18345),g=n(86298),x=n(91046);function b(e){let{onFilter:a}=e;const[n,l]=(0,d.useState)(null),{user:r}=(0,t.G)((e=>e.user)),{filters:o}=(0,t.G)((e=>e.draw.won)),[b,f]=(0,d.useState)([{startDate:c.Py,endDate:c.ZI,key:"selection"}]),j=(0,d.useCallback)((async(e,l)=>{let{setSubmitting:r}=l;null===a||void 0===a||a({...e,radioId:n}),r(!1)}),[a,n]);return(0,x.jsx)(p.l1,{initialValues:{from:i()((null===o||void 0===o?void 0:o.from)||c.Py).format("YYYY-MM-DD"),to:i()((null===o||void 0===o?void 0:o.to)||c.ZI).format("YYYY-MM-DD"),search:null===o||void 0===o?void 0:o.search,tokenId:null===o||void 0===o?void 0:o.tokenId,submit:null},onSubmit:j,children:e=>{var a,t;let{values:o,resetForm:d,isSubmitting:p,handleSubmit:j,handleChange:y,setValues:w}=e;return(0,x.jsxs)("form",{className:"grid gap-3",onSubmit:j,children:[(0,x.jsxs)("div",{className:"hidden",children:[(0,x.jsx)(m.pd,{name:"from",type:"date",value:null===o||void 0===o?void 0:o.from,onChange:y}),(0,x.jsx)(m.pd,{name:"to",type:"date",value:null===o||void 0===o?void 0:o.to,onChange:y})]}),(0,x.jsx)(h.A,{mouseEnterDelay:.5,mouseLeaveDelay:.5,content:(0,x.jsx)(g.Ur,{onChange:e=>{let{selection:a}=e;f([a]),w((e=>({...e,from:i()(a.startDate).format("YYYY-MM-DD"),to:i()(a.endDate).format("YYYY-MM-DD")})))},moveRangeOnFirstSelection:!1,months:1,ranges:b,direction:"horizontal",preventSnapRefocus:!0,calendarFocus:"backwards",rangeColors:["var(--primary-color)"],maxDate:c.ZI,minDate:c.Py}),children:(0,x.jsxs)("div",{className:"cursor-pointer",children:[(0,x.jsx)("p",{className:"mb-1 text-grey",children:"Select Date Range"}),(0,x.jsxs)("span",{className:"flex gap-2 items-center [&>*]:p-1 [&>*]:px-3 [&>*]:bg-light-grey [&>*]:bg-opacity-30 [&>*]:rounded-md",children:[(0,x.jsx)("span",{children:i()(b[0].startDate).format("LL")}),"-",(0,x.jsx)("span",{children:i()(b[0].endDate).format("LL")})]})]})}),1!=(null===r||void 0===r||null===(a=r.attributes)||void 0===a||null===(t=a.radioId)||void 0===t?void 0:t.length)&&(0,x.jsx)(s.A,{radioId:n,setRadioId:l,className:"!col-span-1"}),(0,x.jsx)(m.pd,{name:"tokenId",placeholder:"Token",label:(0,x.jsx)("p",{className:"-mb-2",children:"Token"}),value:null===o||void 0===o?void 0:o.tokenId,onChange:y}),(0,x.jsx)(m.pd,{name:"search",placeholder:"Search",label:(0,x.jsx)("p",{className:"-mb-2",children:"Search"}),value:null===o||void 0===o?void 0:o.search,onChange:y}),(0,x.jsxs)("div",{className:"flex justify-end pt-2 gap-2",children:[(0,x.jsx)(u.A,{onClick:()=>d(),outlined:!0,disabled:p,size:"xsm",className:"!rounded-full",children:"Reset"}),(0,x.jsx)(u.A,{type:"submit",disabled:p,size:"xsm",className:"!rounded-full",icon:p&&(0,x.jsx)(v.A,{size:16}),children:"Filter"})]})]})}})}var f=n(7484),j=n(78468),y=n(16330),w=n(78673),N=(0,n(79).A)("mood-edit","IconMoodEdit",[["path",{d:"M20.955 11.104a9 9 0 1 0 -9.895 9.847",key:"svg-0"}],["path",{d:"M9 10h.01",key:"svg-1"}],["path",{d:"M15 10h.01",key:"svg-2"}],["path",{d:"M9.5 15c.658 .672 1.56 1 2.5 1c.126 0 .251 -.006 .376 -.018",key:"svg-3"}],["path",{d:"M18.42 15.61a2.1 2.1 0 0 1 2.97 2.97l-3.39 3.42h-3v-3l3.42 -3.39z",key:"svg-4"}]]),k=n(34049),C=n(94949);function D(e){let{data:a}=e;return(0,x.jsx)(j.A,{permission:["update_won_token_user_info"],children:(0,x.jsx)(f.A,{children:(0,x.jsx)(j.A,{permission:["update_won_token_user_info"],children:(0,x.jsx)(I,{data:null===a||void 0===a?void 0:a.original})})})})}function I(e){let{data:a}=e;const[n,l]=(0,d.useState)(!1),r=(0,t.j)(),o=(0,d.useCallback)((async(e,n)=>{let{setErrors:l,setStatus:t,setSubmitting:o,setTouched:i,resetForm:d}=n;const s=k.oR.loading("confirming winner..."),{submit:c,...u}=e;try{await r((0,w.em)({token:null===a||void 0===a?void 0:a.id,data:u})).unwrap(),k.oR.update(s,{render:"Winner confirmed successfully!",type:"success",isLoading:!1,autoClose:5e3}),t({success:!0}),i({}),d()}catch(m){k.oR.update(s,{render:"Error in confirming winner.",type:"error",isLoading:!1,autoClose:5e3}),t({success:!1}),l({submit:m.message||"Something went wrong, please try again."})}finally{o(!1)}}),[null===a||void 0===a?void 0:a.id,r]);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"px-4 py-2 hover:bg-black hover:bg-opacity-5 flex items-center",onClick:()=>l(!0),children:[(0,x.jsx)(N,{className:"w-4"}),(0,x.jsx)("span",{className:"pl-3",children:"Edit User"})]}),(0,x.jsx)(y.A,{size:"sm",isOpen:n,onRequestClose:()=>l(!1),children:(0,x.jsx)(p.l1,{initialValues:{name:(null===a||void 0===a?void 0:a.name)||"",age:(null===a||void 0===a?void 0:a.age)||0,gender:(null===a||void 0===a?void 0:a.gender)||"",idNumber:null===a||void 0===a?void 0:a.idNumber,handedOver:null===a||void 0===a?void 0:a.handedOver,handedOverDate:i()(null===a||void 0===a?void 0:a.handedOverDate).format("YYYY-MM-DD HH:mm"),submit:null},validationSchema:C.Ik().shape({name:C.Yj(),age:C.Yj(),gender:C.Yj(),idNumber:C.Yj().required("Id Number is required"),handedOverDate:C.Yj()}),onSubmit:o,children:e=>{let{errors:a,handleBlur:n,handleChange:r,handleSubmit:t,isSubmitting:o,touched:i,values:d}=e;return(0,x.jsxs)("form",{noValidate:!0,onSubmit:t,className:"flex flex-col gap-3 my-4",children:[(0,x.jsx)(y.w,{title:"Edit Winner Info",onClose:()=>l(!1)}),a.submit&&(0,x.jsx)("p",{className:"bg-red-500 p-2 px-4 text-white text-sm text-center rounded-md",dangerouslySetInnerHTML:{__html:a.submit}}),(0,x.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,x.jsx)(m.pd,{type:"text",name:"name",label:"name",placeholder:"Enter name",error:`${a.name||""}`,defaultValue:d.name,onChange:r,onBlur:n,isTouched:Boolean(i.name),boxClassName:"col-span-2"}),(0,x.jsx)(m.pd,{type:"text",name:"age",label:"age",placeholder:"Enter age",error:`${a.age||""}`,defaultValue:d.age,onChange:r,onBlur:n,isTouched:Boolean(i.age)}),(0,x.jsx)(m.l6,{name:"gender",label:"gender",placeholder:"Select Gender",error:`${a.gender||""}`,defaultValue:d.gender,onChange:r,onBlur:n,isTouched:Boolean(i.gender),options:[{value:"M",text:"Male"},{value:"F",text:"Female"}]}),(0,x.jsx)(m.pd,{type:"text",name:"idNumber",label:"Id Number",placeholder:"Enter Id Number",error:`${a.idNumber||""}`,defaultValue:d.idNumber,onChange:r,onBlur:n,isTouched:Boolean(i.idNumber),boxClassName:"col-span-2"}),(0,x.jsxs)("label",{htmlFor:"handedOver",className:"h-full flex gap-4 items-center p-4 rounded bg-black bg-opacity-10",children:[(0,x.jsx)("input",{type:"checkbox",id:"handedOver",defaultChecked:d.handedOver,onChange:r}),(0,x.jsx)("span",{children:"HandOver"})]}),(0,x.jsx)(m.pd,{type:"datetime-local",name:"handedOverDate",label:"handedOverDate",placeholder:"Enter handed Over Date",error:`${a.handedOverDate||""}`,defaultValue:d.handedOverDate,onChange:r,onBlur:n,isTouched:Boolean(i.handedOverDate)})]}),(0,x.jsxs)("div",{className:"flex justify-end pt-2 gap-2",children:[(0,x.jsx)(u.A,{outlined:!0,disabled:o,size:"xsm",className:"!rounded-full",children:"Cancel"}),(0,x.jsx)(u.A,{type:"submit",disabled:o,size:"xsm",className:"!rounded-full",icon:o&&(0,x.jsx)(v.A,{size:16}),children:(0,x.jsx)("span",{children:"Update Winner"})})]})]})}})})]})}var S=n(14206),Y=n(59282);function A(){var e,a;const n=(0,t.j)(),{openPage:o,closePage:s,opened:c}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"page";const[a,n]=(0,Y.ok)(),l=(0,d.useMemo)((()=>null===a||void 0===a?void 0:a.get(e)),[e,a]),r=(0,d.useCallback)((a=>{n((n=>(n.delete(e),n.append(e,a),n)),{replace:!0})}),[e,n]),t=(0,d.useCallback)((()=>{n((a=>(a.delete(e),a)),{replace:!0})}),[e,n]),o=(0,d.useCallback)((e=>{var a;return Array.isArray(e)?null===e||void 0===e||null===(a=e.includes)||void 0===a?void 0:a.call(e,l):e==l}),[l]);return{openPage:r,closePage:t,opened:l,isOpen:o}}("tab"),{list:u,status:m,fetchTimes:v,info:h}=(0,t.G)((e=>e.draw.won)),{user:p}=(0,t.G)((e=>e.user)),{list:g,fetchTimes:f,status:j}=(0,t.G)((e=>e.draw.latest_won)),y=(0,d.useMemo)((()=>[{accessorKey:"tokenId",header:"token"},{accessorKey:"phoneNumber",header:"Phone Number"},{accessorFn:e=>{var a;return i()(`${e.draw.startDate}`).format("ll")+" - "+i()(null===e||void 0===e||null===(a=e.draw)||void 0===a?void 0:a.endDate).format("ll")},header:"draw"},{accessorFn:e=>e.draw.product.productName,header:"Prize"},{accessorFn:e=>e.draw.product.playAmount,header:"Pray Amount",cell:e=>{let{getValue:a}=e;return(0,x.jsx)(l.A,{amount:Number(a())})}},{accessorFn:e=>i()(e.created_at).format("llll"),header:"created date"},{accessorKey:"handedOver",header:"handedOver",cell:e=>{let{getValue:a}=e;return(0,x.jsx)("span",{className:""+(a()?"text-green-600":"text-red-600"),children:a()?"true":"false"})}},{accessorFn:e=>e.handedOverDate?i()(e.handedOverDate).format("llll"):"-",header:"handedOver Date"},{id:"action",cell:e=>{let{row:a}=e;return(0,x.jsx)(D,{data:a})}}]),[]),w=(0,d.useCallback)((async e=>{let{type:a,options:l}=e;try{var t,o,d,s,c,u,m,v;null!==l&&void 0!==l&&null!==(t=l.filters)&&void 0!==t&&t.to&&(l.filters.to=i()(l.filters.to).add("23"==i()(l.filters.to).format("HH")?0:86369,"seconds").format("YYYY-MM-DD HH:mm"));const e={...null===l||void 0===l?void 0:l.filters,pageSize:(null===l||void 0===l?void 0:l.pagination)&&(null===l||void 0===l||null===(o=l.pagination)||void 0===o?void 0:o.pageSize)||10,pageNumber:(null===l||void 0===l?void 0:l.pagination)&&(null!==(d=null===l||void 0===l||null===(s=l.pagination)||void 0===s?void 0:s.pageNumber)&&void 0!==d?d:1)+1};if(1==(null===p||void 0===p||null===(c=p.attributes)||void 0===c||null===(u=c.radioId)||void 0===u?void 0:u.length)&&(e.radioId=(null===p||void 0===p||null===(m=p.attributes)||void 0===m||null===(v=m.radioId)||void 0===v?void 0:v[0])||(null===e||void 0===e?void 0:e.radioId)),"export"==a){const a=await n((0,r.B3)(e)).unwrap();return null===a||void 0===a?void 0:a.list}{const a=await n((0,r.se)(e)).unwrap();return null===a||void 0===a?void 0:a.list}}catch(h){}}),[n,null===p||void 0===p||null===(e=p.attributes)||void 0===e?void 0:e.radioId]),N=(0,d.useCallback)((async()=>{try{var e,a,l,t;const o={};1==(null===p||void 0===p||null===(e=p.attributes)||void 0===e||null===(a=e.radioId)||void 0===a?void 0:a.length)&&(o.radioId=(null===p||void 0===p||null===(l=p.attributes)||void 0===l||null===(t=l.radioId)||void 0===t?void 0:t[0])||(null===o||void 0===o?void 0:o.radioId)),await n((0,r.$w)(o)).unwrap()}catch(o){console.log({error:o})}}),[n,null===p||void 0===p||null===(a=p.attributes)||void 0===a?void 0:a.radioId]);return(0,d.useLayoutEffect)((()=>{0==v&&w({}),0==f&&N()}),[v,w,N,f]),(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:"p-4",children:[(0,x.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4 [&>.active]:bg-primary [&>.active]:font-semibold [&>.active]:text-white [&>*]:inline-block [&>*]:cursor-pointer [&>*]:rounded-md [&>*]:p-2 [&>*]:px-4 [&>*]:bg-light-grey",children:[(0,x.jsx)("span",{onClick:()=>s(),className:""+(null==c?"active":""),children:"Latest Winners"}),(0,x.jsx)("span",{onClick:()=>o("all"),className:""+("all"==c?"active":""),children:"All Winners"})]}),"all"==c?(0,x.jsx)(S.A,{title:"winners",columns:y,data:u,loading:"pending"==m,allowExport:!0,AsideNode:b,customPagination:!0,getData:w,pagination:{totalPages:null===h||void 0===h?void 0:h.lastPage,pageNumber:((null===h||void 0===h?void 0:h.currentPage)||1)-1,pageSize:(null===u||void 0===u?void 0:u.length)<10?10:null===u||void 0===u?void 0:u.length,total:null===h||void 0===h?void 0:h.total}},"all"):(0,x.jsx)(S.A,{title:"Latest winners",columns:y,data:g,loading:"pending"==j,getData:N,allowExport:!0},"latest")]})})}}}]);
//# sourceMappingURL=416.d2361d75.chunk.js.map