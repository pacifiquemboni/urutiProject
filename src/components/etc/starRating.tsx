import { Fragment, useMemo } from "react";

export function StarRating({ rate = 0 }: { rate: number }) {
  const ActiveStarSVG = useMemo(
    () => (
      <svg
        width="14"
        height="14"
        viewBox="0 0 14 14"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M2.82641 9.66683C2.89974 9.34016 2.76641 8.8735 2.53308 8.64016L0.913076 7.02016C0.40641 6.5135 0.20641 5.9735 0.353077 5.50683C0.50641 5.04016 0.979743 4.72016 1.68641 4.60016L3.76641 4.2535C4.06641 4.20016 4.43308 3.9335 4.57308 3.66016L5.71976 1.36016C6.0531 0.700163 6.50643 0.333496 6.99976 0.333496C7.4931 0.333496 7.94643 0.700163 8.27976 1.36016L9.42643 3.66016C9.5131 3.8335 9.6931 4.00016 9.88643 4.1135L2.70641 11.2935C2.61308 11.3868 2.45308 11.3002 2.47974 11.1668L2.82641 9.66683Z"
          fill="var(--primary-color)"
        />
        <path
          d="M11.4672 8.63977C11.2272 8.87977 11.0939 9.33977 11.1739 9.66643L11.6339 11.6731C11.8272 12.5064 11.7072 13.1331 11.2939 13.4331C11.1272 13.5531 10.9272 13.6131 10.6939 13.6131C10.3539 13.6131 9.95387 13.4864 9.51387 13.2264L7.56053 12.0664C7.25387 11.8864 6.7472 11.8864 6.44053 12.0664L4.48719 13.2264C3.74719 13.6598 3.11385 13.7331 2.70719 13.4331C2.55385 13.3198 2.44052 13.1664 2.36719 12.9664L10.4739 4.85977C10.7805 4.5531 11.2139 4.4131 11.6339 4.48644L12.3072 4.59977C13.0139 4.71977 13.4872 5.03977 13.6405 5.50644C13.7872 5.9731 13.5872 6.5131 13.0805 7.01977L11.4672 8.63977Z"
          fill="var(--primary-color)"
        />
      </svg>
    ),
    [],
  );
  const HalfStarSVG = useMemo(
    () => (
      <svg
        width="14"
        height="14"
        viewBox="0 0 14 14"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M2.82641 9.66683C2.89974 9.34016 2.76641 8.8735 2.53308 8.64016L0.913076 7.02016C0.40641 6.5135 0.20641 5.9735 0.353077 5.50683C0.50641 5.04016 0.979743 4.72016 1.68641 4.60016L3.76641 4.2535C4.06641 4.20016 4.43308 3.9335 4.57308 3.66016L5.71976 1.36016C6.0531 0.700163 6.50643 0.333496 6.99976 0.333496C7.4931 0.333496 7.94643 0.700163 8.27976 1.36016L9.42643 3.66016C9.5131 3.8335 9.6931 4.00016 9.88643 4.1135L2.70641 11.2935C2.61308 11.3868 2.45308 11.3002 2.47974 11.1668L2.82641 9.66683Z"
          fill="var(--primary-color)"
        />
        <path
          d="M11.4672 8.63977C11.2272 8.87977 11.0939 9.33977 11.1739 9.66643L11.6339 11.6731C11.8272 12.5064 11.7072 13.1331 11.2939 13.4331C11.1272 13.5531 10.9272 13.6131 10.6939 13.6131C10.3539 13.6131 9.95387 13.4864 9.51387 13.2264L7.56053 12.0664C7.25387 11.8864 6.7472 11.8864 6.44053 12.0664L4.48719 13.2264C3.74719 13.6598 3.11385 13.7331 2.70719 13.4331C2.55385 13.3198 2.44052 13.1664 2.36719 12.9664L10.4739 4.85977C10.7805 4.5531 11.2139 4.4131 11.6339 4.48644L12.3072 4.59977C13.0139 4.71977 13.4872 5.03977 13.6405 5.50644C13.7872 5.9731 13.5872 6.5131 13.0805 7.01977L11.4672 8.63977Z"
          fill="var(--light-grey-color)"
        />
      </svg>
    ),
    [],
  );
  const StarSVG = useMemo(
    () => (
      <svg
        width="14"
        height="14"
        viewBox="0 0 14 14"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M2.82641 9.66683C2.89974 9.34016 2.76641 8.8735 2.53308 8.64016L0.913076 7.02016C0.40641 6.5135 0.20641 5.9735 0.353077 5.50683C0.50641 5.04016 0.979743 4.72016 1.68641 4.60016L3.76641 4.2535C4.06641 4.20016 4.43308 3.9335 4.57308 3.66016L5.71976 1.36016C6.0531 0.700163 6.50643 0.333496 6.99976 0.333496C7.4931 0.333496 7.94643 0.700163 8.27976 1.36016L9.42643 3.66016C9.5131 3.8335 9.6931 4.00016 9.88643 4.1135L2.70641 11.2935C2.61308 11.3868 2.45308 11.3002 2.47974 11.1668L2.82641 9.66683Z"
          fill="var(--light-grey-color)"
        />
        <path
          d="M11.4672 8.63977C11.2272 8.87977 11.0939 9.33977 11.1739 9.66643L11.6339 11.6731C11.8272 12.5064 11.7072 13.1331 11.2939 13.4331C11.1272 13.5531 10.9272 13.6131 10.6939 13.6131C10.3539 13.6131 9.95387 13.4864 9.51387 13.2264L7.56053 12.0664C7.25387 11.8864 6.7472 11.8864 6.44053 12.0664L4.48719 13.2264C3.74719 13.6598 3.11385 13.7331 2.70719 13.4331C2.55385 13.3198 2.44052 13.1664 2.36719 12.9664L10.4739 4.85977C10.7805 4.5531 11.2139 4.4131 11.6339 4.48644L12.3072 4.59977C13.0139 4.71977 13.4872 5.03977 13.6405 5.50644C13.7872 5.9731 13.5872 6.5131 13.0805 7.01977L11.4672 8.63977Z"
          fill="var(--light-grey-color)"
        />
      </svg>
    ),
    [],
  );

  const stars = useMemo(() => {
    const activeStars = new Array(Math.floor(rate)).fill(ActiveStarSVG);
    const blackStars = new Array(Math.floor(5 - rate)).fill(StarSVG);
    const halfStars = new Array(Math.floor(5 - activeStars.length - blackStars.length)).fill(
      HalfStarSVG,
    );
    return [...activeStars, ...halfStars, ...blackStars];
  }, [ActiveStarSVG, HalfStarSVG, StarSVG, rate]);

  return (
    <span className="flex gap-0.5">
      {stars.map((s, i) => (
        <Fragment key={i}>{s}</Fragment>
      ))}
    </span>
  );
}
